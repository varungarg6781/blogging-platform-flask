pull_request:

push:
  branches:
    - main

schedule:
  - cron: '0 0 * * 0'

permissions:
  actions: read
  contents: write
  checks: write
  pull-requests: write

with:
  ref: ${{ github.event.pull_request.head.ref }}

- name: Install AppMap tools
  id: install-appmap
  uses: getappmap/install-action@v1
  with:
    project-type: pipenv
    build-patch-file: false

- name: Commit changes
  uses: EndBug/add-and-commit@v9

- name: Archive AppMaps
  uses: getappmap/archive-action@v1
  with:
    revision: ${{ github.event.pull_request.base.sha }}
